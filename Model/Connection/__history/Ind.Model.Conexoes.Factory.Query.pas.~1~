unit Ind.Model.Conexoes.Factory.Query;

interface

uses Ind.Model.Conexoes.Interfaces, Ind.Controller.Conexoes.Factory.Conexao,
  Ind.Model.Conexoes.QueryFireDac;


Type
  TModelFactoryQuery = class(TInterfacedObject, iModelFactoryQuery)
    private
    FConexao : iModelConexao;
    FQuery : iQuery;

    public
      constructor Create(Conexao : iModelConexao);
      destructor Destroy; override;
      class function New(Conexao : iModelConexao) : iModelFactoryQuery;
      function Query : iQuery;
  end;

implementation

{ TModelConexaoFactoryDataSet }

constructor TModelFactoryQuery.Create(Conexao : iModelConexao);
begin
  FConexao := Conexao;
  FQuery := TFiredacModelQuery.New(FConexao);

end;

destructor TModelFactoryQuery.Destroy;
begin
  inherited;
end;

class function TModelFactoryQuery.New(Conexao : iModelConexao): iModelFactoryQuery;
begin
  Result := Self.Create(Conexao);
end;

function TModelFactoryQuery.Query: iQuery;
begin
  Result := FQuery;
end;

end.
